# -*- coding: utf-8 -*-
"""
generate乡土中国.py
一键生成《乡土中国》14 章阅读记录卡片 Word 文件
运行前：pip install python-docx
"""
from docx import Document
from docx.enum.table import WD_ALIGN_VERTICAL
from docx.shared import Cm, Pt
from docx.oxml.ns import qn

# 14 章完整数据：标题、核心概念、主要观点、论述逻辑、我的收获、我的疑问
chapters = [
    ("乡土中国·第1章：乡土本色",
     "乡土性、熟人社会、面对面社群",
     "中国社会基层是“乡土性”的，人情关系以地缘和血缘为基础，形成熟人社会。",
     "从土地与人的关系出发 → 引出乡土社会的特征 → 对比现代社会。",
     "意识到“乡土”不仅是地理概念，更是社会结构的原型。",
     "今天的城市化在多大程度上真正摆脱了乡土性？"),

    ("乡土中国·第2章：文字下乡",
     "文字的功能、文化传递、象征体系",
     "文字在乡土社会中并非必需，文化传承主要靠口耳相传。",
     "从文字的功能谈起 → 乡土社会的非文字性 → 文字的“外来性”问题。",
     "理解了“口语文明”与“文字文明”的巨大差异。",
     "数字时代图像/视频是否会重演“文字下乡”的困境？"),

    ("乡土中国·第3章：再论文字下乡",
     "文字普及的局限性、文化隔阂、教育差异",
     "文字下乡难以真正改变乡土社会，因其与乡土的生活经验脱节。",
     "从文字与生活的脱节谈起 → 教育内容与乡土需求的错位 → 文化传递的障碍。",
     "任何外来知识都必须与本地经验“嫁接”才能生根。",
     "今天的乡村教育如何真正做到内容与情境匹配？"),

    ("乡土中国·第4章：差序格局",
     "差序格局、人伦、关系网络",
     "中国人的社会关系是以“己”为中心、向外推的“差序格局”。",
     "从“团体格局”对比 → 引出“差序格局” → 举例说明人伦关系的伸缩性。",
     "对“关系社会”有了结构性视角，而非简单批判。",
     "差序格局在全球化网络中会被削弱还是强化？"),

    ("乡土中国·第5章：系维着私人的道德",
     "私人道德、公私界限、道德相对主义",
     "乡土社会的道德标准是“看人下菜碟”，缺乏普遍主义。",
     "从道德实践出发 → 公私不分 → 道德判断的情境性。",
     "情境伦理并非落后，而是对熟人社会的功能性适应。",
     "法治建设如何与情境伦理衔接而非冲突？"),

    ("乡土中国·第6章：家族",
     "家族、宗族、父权制度",
     "家族不仅是血缘单位，更是经济和政治单位，强调父权与延续性。",
     "从家庭结构谈起 → 家族的功能 → 与西方家庭的对比。",
     "理解了“家”在中国传统中的“小共同体”性质。",
     "核心家庭化趋势下，家族的功能被谁替代？"),

    ("乡土中国·第7章：男女有别",
     "性别分工、礼教、男女隔离",
     "乡土社会中男女关系被严格规范，强调“男女有别”以维护家族秩序。",
     "从性别角色谈起 → 礼教的作用 → 社会秩序的需要。",
     "看到礼教背后的“秩序理性”，而非单纯的性别压迫。",
     "现代社会仍需“有别”吗？界限应划在哪里？"),

    ("乡土中国·第8章：礼治秩序",
     "礼治、无讼、传统权威",
     "乡土社会靠“礼”维持秩序，而非法律，追求“无讼”理想。",
     "从秩序维持方式谈起 → 礼的功能 → 与法治社会的对比。",
     "“礼”是一套低成本、高认同的治理技术。",
     "当代调解机制如何创造性转化传统礼治？"),

    ("乡土中国·第9章：无讼",
     "无讼理想、调解机制、冲突解决",
     "乡土社会崇尚“无讼”，冲突通过调解而非对抗解决。",
     "从诉讼观念谈起 → 调解机制 → 社会和谐的价值观。",
     "“无讼”并非无矛盾，而是对矛盾的柔性消化。",
     "在高流动社会，“无讼”是否仍可能？"),

    ("乡土中国·第10章：无为政治",
     "无为、长老统治、权力结构",
     "乡土社会的权力结构是“长老统治”，强调经验与稳定，反对激进变革。",
     "从权力来源谈起 → 长老权威 → 社会稳定机制。",
     "“经验权力”与“知识权力”的张力古今皆然。",
     "老龄化社会是否会再次强化长老统治？"),

    ("乡土中国·第11章：长老统治",
     "长老权威、经验至上、代际传承",
     "乡土社会的统治者是“长老”，其权威来自经验与辈分。",
     "从权力合法性谈起 → 经验 vs 知识 → 代际关系。",
     "认识到“敬老”不仅是伦理，更是治理技术。",
     "当经验贬值、技术加速，长老统治如何转型？"),

    ("乡土中国·第12章：血缘与地缘",
     "血缘关系、地缘关系、社会整合",
     "乡土社会以血缘为纽带，地缘是血缘的投影，二者共同维系社会秩序。",
     "从社会结构谈起 → 血缘优先 → 地缘的从属性。",
     "对“同乡会”“宗亲会”的现代变体有了新理解。",
     "城市化后，“地缘”能否脱离血缘而独立作用？"),

    ("乡土中国·第13章：名实的分离",
     "名义与实际、形式主义、传统与变迁",
     "随着社会变迁，传统名义与实际行为逐渐脱节，出现“名实分离”。",
     "从社会变迁谈起 → 名义的滞后性 → 行为与观念的张力。",
     "看到“形式主义”在社会转型期的功能与困境并存。",
     "如何减少“名实分离”带来的制度内耗？"),

    ("乡土中国·第14章：从欲望到需要",
     "欲望、需要、理性化",
     "乡土社会的行为由“欲望”驱动，现代社会则转向“需要”，体现理性化趋势。",
     "从行为动机谈起 → 欲望的自然性 → 需要的计划性 → 社会转型。",
     "意识到消费主义其实把“欲望”包装成“需要”。",
     "在算法推荐时代，个人如何区分真实需要与被制造的需要？")
]

# 创建 Word
doc = Document()
style = doc.styles['Normal']
style.font.name = '宋体'
style._element.rPr.rFonts.set(qn('w:eastAsia'), '宋体')
style.font.size = Pt(10.5)

for title, concept, view, logic, gain, question in chapters:
    # rows 行 3 列表格
    table = doc.add_table(rows=5, cols=3)
    table.style = 'Table Grid'
    for col in table.columns:
        col.width = Cm(5.2)

    # 第1行：标题跨三列
    hdr = table.rows[0]
    hdr.cells[0].text = title
    hdr.cells[0].merge(hdr.cells[2])
    hdr.cells[0].vertical_alignment = WD_ALIGN_VERTICAL.CENTER

    # 第2行：表头
    row2 = table.rows[1]
    row2.cells[0].text = "核心概念"
    row2.cells[1].text = "主要观点"
    row2.cells[2].text = "论述逻辑"

    # 第3行：内容
    row3 = table.rows[2]
    row3.cells[0].text = concept
    row3.cells[1].text = view
    row3.cells[2].text = logic

    # 第4行：分隔
    row4 = table.rows[3]
    row4.cells[0].text = "我的收获"
    row4.cells[1].text = ""
    row4.cells[2].text = "我的疑问"

    # 第5行：填写收获 & 疑问
    row5 = table.rows[4]
    row5.cells[0].text = gain
    row5.cells[0].merge(row5.cells[1])
    row5.cells[2].text = question
    for cell in row5.cells:
        cell.vertical_alignment = WD_ALIGN_VERTICAL.TOP

    # 第6行：预留空行
    #row6 = table.rows[5]
    #row6.cells[0].text = ""
    #row6.cells[0].merge(row6.cells[1])
    #row6.cells[2].text = ""
    #row6.height = Cm(1.4)

    # 章节间隔
    doc.add_paragraph("")

# 保存
doc.save("乡土中国14章阅读记录卡片.docx")
print("✅ 已生成：乡土中国14章阅读记录卡片.docx")